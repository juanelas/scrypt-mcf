import{decode as r,encode as t}from"@juanelas/base64";import{salt as o,scrypt as n}from"scrypt-pbkdf";async function a(a,l,p,$=32){const c={logN:17,r:8,p:1,...p},e={N:2**c.logN,r:c.r,p:c.p},s=void 0!==l?r(l):o(),i=t(s,!1,!1),g=t(await n(a,s,$,e),!1,!1);return`$scrypt$ln=${c.logN},r=${c.r},p=${c.p}$${i}$${g}`}async function l(r,t){const o=[...t.matchAll(/^\$scrypt\$ln=(\d{1,2}),r=(\d{1,2}),p=(\d{1,2})\$([a-zA-Z0-9/+]{22})\$([a-zA-Z0-9/+]{22,})$/g)];if(1!==o.length)throw new Error("Invalid MCFstring format");const n=Number(o[0][1]),l=Number(o[0][2]),p=Number(o[0][3]),$=o[0][4],c=2**(Math.floor(Math.log2(6*o[0][5].length))-3);return await a(r,$,{logN:n,r:l,p:p},c)===t}export{a as kdf,l as verify};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgubm9kZS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3RzL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpudWxsLCJuYW1lcyI6WyJhc3luYyIsImtkZiIsInBhc3N3b3JkIiwic2FsdEJhc2U2NCIsInBhcmFtcyIsImRlcml2ZWRLZXlMZW5ndGgiLCJzY3J5cHRQYXJhbXMiLCJsb2dOIiwiciIsInAiLCJzY3J5cHRQYmtkZlBhcmFtcyIsIk4iLCJTIiwidW5kZWZpbmVkIiwiYjY0ZGVjb2RlIiwiZ2V0UmFuZG9tU2FsdCIsIlNCYXNlNjQiLCJiNjRlbmNvZGUiLCJoYXNoIiwic2NyeXB0IiwidmVyaWZ5IiwibWNmIiwibWF0Y2hlcyIsIm1hdGNoQWxsIiwibGVuZ3RoIiwiRXJyb3IiLCJOdW1iZXIiLCJNYXRoIiwiZmxvb3IiLCJsb2cyIl0sIm1hcHBpbmdzIjoic0dBdUJPQSxlQUFlQyxFQUFLQyxFQUFrQkMsRUFBcUJDLEVBQXVCQyxFQUFtQixJQUMxRyxNQUFNQyxFQUF1QyxDQUMzQ0MsS0FBTSxHQUNOQyxFQUFHLEVBQ0hDLEVBQUcsS0FDQUwsR0FFQ00sRUFBdUMsQ0FDM0NDLEVBQUcsR0FBS0wsRUFBYUMsS0FDckJDLEVBQUdGLEVBQWFFLEVBQ2hCQyxFQUFHSCxFQUFhRyxHQUVaRyxPQUFvQkMsSUFBZlYsRUFBNEJXLEVBQVVYLEdBQWNZLElBQ3pEQyxFQUFVQyxFQUFVTCxHQUFHLEdBQU8sR0FDOUJNLEVBQU9ELFFBQWdCRSxFQUFPakIsRUFBVVUsRUFBR1AsRUFBa0JLLElBQW9CLEdBQU8sR0FDOUYsTUFBTyxjQUFjSixFQUFhQyxVQUFVRCxFQUFhRSxPQUFPRixFQUFhRyxLQUFLTyxLQUFXRSxHQUMvRixDQVFPbEIsZUFBZW9CLEVBQVFsQixFQUFrQm1CLEdBQzlDLE1BRU1DLEVBQVUsSUFBSUQsRUFBSUUsU0FGVixpR0FJZCxHQUF1QixJQUFuQkQsRUFBUUUsT0FDVixNQUFNLElBQUlDLE1BQU0sNEJBR2xCLE1BQU1sQixFQUFPbUIsT0FBT0osRUFBUSxHQUFHLElBQ3pCZCxFQUFJa0IsT0FBT0osRUFBUSxHQUFHLElBQ3RCYixFQUFJaUIsT0FBT0osRUFBUSxHQUFHLElBQ3RCVixFQUFJVSxFQUFRLEdBQUcsR0FDZmpCLEVBQW1CLElBQU1zQixLQUFLQyxNQUFNRCxLQUFLRSxLQUE0QixFQUF2QlAsRUFBUSxHQUFHLEdBQUdFLFNBQWUsR0FJakYsYUFGMEJ2QixFQUFJQyxFQUFVVSxFQUFHLENBQUVMLE9BQU1DLElBQUdDLEtBQUtKLEtBRXBDZ0IsQ0FDekIifQ==
