import{decode as r,encode as t}from"@juanelas/base64";import{salt as a,scrypt as n}from"scrypt-pbkdf";async function o(o,e){const s={logN:17,r:8,p:1,...e?.scryptParams},l={N:2**s.logN,r:s.r,p:s.p},d=void 0!==e?.saltBase64NoPadding?r(e.saltBase64NoPadding):a(),p=t(d,!1,!1),i=e?.derivedKeyLength??32,g=t(await n(o,d,i,l),!1,!1);return`$scrypt$ln=${s.logN},r=${s.r},p=${s.p}$${p}$${g}`}async function e(r,t){const a=[...t.matchAll(/^\$scrypt\$ln=(\d{1,2}),r=(\d{1,2}),p=(\d{1,2})\$([a-zA-Z0-9/+]{22})\$([a-zA-Z0-9/+]{22,})$/g)];if(1!==a.length)throw new Error("Invalid MCFstring format");const n=Number(a[0][1]),e=Number(a[0][2]),s=Number(a[0][3]),l=a[0][4],d=2**(Math.floor(Math.log2(6*a[0][5].length))-3);return await o(r,{saltBase64NoPadding:l,scryptParams:{logN:n,r:e,p:s},derivedKeyLength:d})===t}export{o as hash,e as verify};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgubm9kZS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3RzL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpudWxsLCJuYW1lcyI6WyJhc3luYyIsImhhc2giLCJwYXNzd29yZCIsIm9wdGlvbnMiLCJzY3J5cHRQYXJhbXMiLCJsb2dOIiwiciIsInAiLCJzY3J5cHRQYmtkZlBhcmFtcyIsIk4iLCJTIiwidW5kZWZpbmVkIiwic2FsdEJhc2U2NE5vUGFkZGluZyIsImI2NGRlY29kZSIsImdldFJhbmRvbVNhbHQiLCJTQmFzZTY0IiwiYjY0ZW5jb2RlIiwiZGVyaXZlZEtleUxlbmd0aCIsInNjcnlwdCIsInZlcmlmeSIsIm1jZiIsIm1hdGNoZXMiLCJtYXRjaEFsbCIsImxlbmd0aCIsIkVycm9yIiwiTnVtYmVyIiwiTWF0aCIsImZsb29yIiwibG9nMiJdLCJtYXBwaW5ncyI6InNHQTJCT0EsZUFBZUMsRUFBTUMsRUFBa0JDLEdBQzVDLE1BQU1DLEVBQXVDLENBQzNDQyxLQUFNLEdBQ05DLEVBQUcsRUFDSEMsRUFBRyxLQUNBSixHQUFTQyxjQUVSSSxFQUF1QyxDQUMzQ0MsRUFBRyxHQUFLTCxFQUFhQyxLQUNyQkMsRUFBR0YsRUFBYUUsRUFDaEJDLEVBQUdILEVBQWFHLEdBRVpHLE9BQXNDQyxJQUFqQ1IsR0FBU1Msb0JBQXFDQyxFQUFVVixFQUFRUyxxQkFBdUJFLElBQzVGQyxFQUFVQyxFQUFVTixHQUFHLEdBQU8sR0FDOUJPLEVBQW1CZCxHQUFTYyxrQkFBb0IsR0FDaERoQixFQUFPZSxRQUFnQkUsRUFBT2hCLEVBQVVRLEVBQUdPLEVBQWtCVCxJQUFvQixHQUFPLEdBQzlGLE1BQU8sY0FBY0osRUFBYUMsVUFBVUQsRUFBYUUsT0FBT0YsRUFBYUcsS0FBS1EsS0FBV2QsR0FDL0YsQ0FRT0QsZUFBZW1CLEVBQVFqQixFQUFrQmtCLEdBQzlDLE1BRU1DLEVBQVUsSUFBSUQsRUFBSUUsU0FGVixpR0FJZCxHQUF1QixJQUFuQkQsRUFBUUUsT0FDVixNQUFNLElBQUlDLE1BQU0sNEJBR2xCLE1BQU1uQixFQUFPb0IsT0FBT0osRUFBUSxHQUFHLElBQ3pCZixFQUFJbUIsT0FBT0osRUFBUSxHQUFHLElBQ3RCZCxFQUFJa0IsT0FBT0osRUFBUSxHQUFHLElBQ3RCWCxFQUFJVyxFQUFRLEdBQUcsR0FDZkosRUFBbUIsSUFBTVMsS0FBS0MsTUFBTUQsS0FBS0UsS0FBNEIsRUFBdkJQLEVBQVEsR0FBRyxHQUFHRSxTQUFlLEdBUWpGLGFBTjBCdEIsRUFBS0MsRUFBVSxDQUN2Q1Usb0JBQXFCRixFQUNyQk4sYUFBYyxDQUFFQyxPQUFNQyxJQUFHQyxLQUN6QlUsdUJBR3FCRyxDQUN6QiJ9
