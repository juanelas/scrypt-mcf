"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@juanelas/base64"),r=require("scrypt-pbkdf");async function t(t,a){const s={logN:17,r:8,p:1,...a?.scryptParams},n={N:2**s.logN,r:s.r,p:s.p},o=void 0!==a?.saltBase64NoPadding?e.decode(a.saltBase64NoPadding):r.salt(),d=e.encode(o,!1,!1),l=a?.derivedKeyLength??32,c=e.encode(await r.scrypt(t,o,l,n),!1,!1);return`$scrypt$ln=${s.logN},r=${s.r},p=${s.p}$${d}$${c}`}exports.hash=t,exports.verify=async function(e,r){const a=[...r.matchAll(/^\$scrypt\$ln=(\d{1,2}),r=(\d{1,2}),p=(\d{1,2})\$([a-zA-Z0-9/+]{22})\$([a-zA-Z0-9/+]{22,})$/g)];if(1!==a.length)throw new Error("Invalid MCFstring format");const s=Number(a[0][1]),n=Number(a[0][2]),o=Number(a[0][3]),d=a[0][4],l=2**(Math.floor(Math.log2(6*a[0][5].length))-3);return await t(e,{saltBase64NoPadding:d,scryptParams:{logN:s,r:n,p:o},derivedKeyLength:l})===r};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgubm9kZS5janMiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90cy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6bnVsbCwibmFtZXMiOlsiYXN5bmMiLCJoYXNoIiwicGFzc3dvcmQiLCJvcHRpb25zIiwic2NyeXB0UGFyYW1zIiwibG9nTiIsInIiLCJwIiwic2NyeXB0UGJrZGZQYXJhbXMiLCJOIiwiUyIsInVuZGVmaW5lZCIsInNhbHRCYXNlNjROb1BhZGRpbmciLCJiNjRkZWNvZGUiLCJkZWNvZGUiLCJnZXRSYW5kb21TYWx0IiwiU0Jhc2U2NCIsImI2NGVuY29kZSIsImVuY29kZSIsImRlcml2ZWRLZXlMZW5ndGgiLCJzY3J5cHQiLCJtY2YiLCJtYXRjaGVzIiwibWF0Y2hBbGwiLCJsZW5ndGgiLCJFcnJvciIsIk51bWJlciIsIk1hdGgiLCJmbG9vciIsImxvZzIiXSwibWFwcGluZ3MiOiJnSUEyQk9BLGVBQWVDLEVBQU1DLEVBQWtCQyxHQUM1QyxNQUFNQyxFQUF1QyxDQUMzQ0MsS0FBTSxHQUNOQyxFQUFHLEVBQ0hDLEVBQUcsS0FDQUosR0FBU0MsY0FFUkksRUFBdUMsQ0FDM0NDLEVBQUcsR0FBS0wsRUFBYUMsS0FDckJDLEVBQUdGLEVBQWFFLEVBQ2hCQyxFQUFHSCxFQUFhRyxHQUVaRyxPQUFzQ0MsSUFBakNSLEdBQVNTLG9CQUFxQ0MsRUFBU0MsT0FBQ1gsRUFBUVMscUJBQXVCRyxFQUFBQSxPQUM1RkMsRUFBVUMsRUFBU0MsT0FBQ1IsR0FBRyxHQUFPLEdBQzlCUyxFQUFtQmhCLEdBQVNnQixrQkFBb0IsR0FDaERsQixFQUFPZ0IsRUFBQUEsYUFBZ0JHLEVBQUFBLE9BQU9sQixFQUFVUSxFQUFHUyxFQUFrQlgsSUFBb0IsR0FBTyxHQUM5RixNQUFPLGNBQWNKLEVBQWFDLFVBQVVELEVBQWFFLE9BQU9GLEVBQWFHLEtBQUtTLEtBQVdmLEdBQy9GLCtCQVFPRCxlQUF1QkUsRUFBa0JtQixHQUM5QyxNQUVNQyxFQUFVLElBQUlELEVBQUlFLFNBRlYsaUdBSWQsR0FBdUIsSUFBbkJELEVBQVFFLE9BQ1YsTUFBTSxJQUFJQyxNQUFNLDRCQUdsQixNQUFNcEIsRUFBT3FCLE9BQU9KLEVBQVEsR0FBRyxJQUN6QmhCLEVBQUlvQixPQUFPSixFQUFRLEdBQUcsSUFDdEJmLEVBQUltQixPQUFPSixFQUFRLEdBQUcsSUFDdEJaLEVBQUlZLEVBQVEsR0FBRyxHQUNmSCxFQUFtQixJQUFNUSxLQUFLQyxNQUFNRCxLQUFLRSxLQUE0QixFQUF2QlAsRUFBUSxHQUFHLEdBQUdFLFNBQWUsR0FRakYsYUFOMEJ2QixFQUFLQyxFQUFVLENBQ3ZDVSxvQkFBcUJGLEVBQ3JCTixhQUFjLENBQUVDLE9BQU1DLElBQUdDLEtBQ3pCWSx1QkFHcUJFLENBQ3pCIn0=
