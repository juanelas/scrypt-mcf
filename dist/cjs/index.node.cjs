"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("@juanelas/base64"),e=require("scrypt-pbkdf");async function t(t,o,n,a=32){const s={logN:17,r:8,p:1,...n},c={N:2**s.logN,r:s.r,p:s.p},l=void 0!==o?r.decode(o):e.salt(),p=r.encode(l,!1,!1),$=r.encode(await e.scrypt(t,l,a,c),!1,!1);return`$scrypt$ln=${s.logN},r=${s.r},p=${s.p}$${p}$${$}`}exports.kdf=t,exports.verify=async function(r,e){const o=[...e.matchAll(/^\$scrypt\$ln=(\d{1,2}),r=(\d{1,2}),p=(\d{1,2})\$([a-zA-Z0-9/+]{22})\$([a-zA-Z0-9/+]{22,})$/g)];if(1!==o.length)throw new Error("Invalid MCFstring format");const n=Number(o[0][1]),a=Number(o[0][2]),s=Number(o[0][3]),c=o[0][4],l=2**(Math.floor(Math.log2(6*o[0][5].length))-3);return await t(r,c,{logN:n,r:a,p:s},l)===e};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXgubm9kZS5janMiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90cy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6bnVsbCwibmFtZXMiOlsiYXN5bmMiLCJrZGYiLCJwYXNzd29yZCIsInNhbHRCYXNlNjQiLCJwYXJhbXMiLCJkZXJpdmVkS2V5TGVuZ3RoIiwic2NyeXB0UGFyYW1zIiwibG9nTiIsInIiLCJwIiwic2NyeXB0UGJrZGZQYXJhbXMiLCJOIiwiUyIsInVuZGVmaW5lZCIsImI2NGRlY29kZSIsImdldFJhbmRvbVNhbHQiLCJTQmFzZTY0IiwiYjY0ZW5jb2RlIiwiZW5jb2RlIiwiaGFzaCIsInNjcnlwdCIsIm1jZiIsIm1hdGNoZXMiLCJtYXRjaEFsbCIsImxlbmd0aCIsIkVycm9yIiwiTnVtYmVyIiwiTWF0aCIsImZsb29yIiwibG9nMiJdLCJtYXBwaW5ncyI6ImdJQXVCT0EsZUFBZUMsRUFBS0MsRUFBa0JDLEVBQXFCQyxFQUF1QkMsRUFBbUIsSUFDMUcsTUFBTUMsRUFBdUMsQ0FDM0NDLEtBQU0sR0FDTkMsRUFBRyxFQUNIQyxFQUFHLEtBQ0FMLEdBRUNNLEVBQXVDLENBQzNDQyxFQUFHLEdBQUtMLEVBQWFDLEtBQ3JCQyxFQUFHRixFQUFhRSxFQUNoQkMsRUFBR0gsRUFBYUcsR0FFWkcsT0FBb0JDLElBQWZWLEVBQTRCVyxFQUFBQSxPQUFVWCxHQUFjWSxFQUFBQSxPQUN6REMsRUFBVUMsRUFBU0MsT0FBQ04sR0FBRyxHQUFPLEdBQzlCTyxFQUFPRixFQUFBQSxhQUFnQkcsRUFBQUEsT0FBT2xCLEVBQVVVLEVBQUdQLEVBQWtCSyxJQUFvQixHQUFPLEdBQzlGLE1BQU8sY0FBY0osRUFBYUMsVUFBVUQsRUFBYUUsT0FBT0YsRUFBYUcsS0FBS08sS0FBV0csR0FDL0YsOEJBUU9uQixlQUF1QkUsRUFBa0JtQixHQUM5QyxNQUVNQyxFQUFVLElBQUlELEVBQUlFLFNBRlYsaUdBSWQsR0FBdUIsSUFBbkJELEVBQVFFLE9BQ1YsTUFBTSxJQUFJQyxNQUFNLDRCQUdsQixNQUFNbEIsRUFBT21CLE9BQU9KLEVBQVEsR0FBRyxJQUN6QmQsRUFBSWtCLE9BQU9KLEVBQVEsR0FBRyxJQUN0QmIsRUFBSWlCLE9BQU9KLEVBQVEsR0FBRyxJQUN0QlYsRUFBSVUsRUFBUSxHQUFHLEdBQ2ZqQixFQUFtQixJQUFNc0IsS0FBS0MsTUFBTUQsS0FBS0UsS0FBNEIsRUFBdkJQLEVBQVEsR0FBRyxHQUFHRSxTQUFlLEdBSWpGLGFBRjBCdkIsRUFBSUMsRUFBVVUsRUFBRyxDQUFFTCxPQUFNQyxJQUFHQyxLQUFLSixLQUVwQ2dCLENBQ3pCIn0=
